{"ast":null,"code":"/*import React,{useEffect, useRef,useState,useContext} from 'react'\r\nimport '../styles/tour-details.css'\r\nimport { Container , Row , Col , Form , ListGroup } from 'reactstrap'\r\nimport { useParams } from 'react-router-dom';\r\n\r\nimport calculateAvgRating from '../utils/avgRating';\r\nimport avatar from '../assets/images/avatar.jpg'\r\nimport Booking from '../components/Booking/Booking';\r\nimport useFetch from './../hooks/useFetch';\r\nimport {BASE_URL} from './../utils/config';\r\n\r\nimport { AuthContext } from './../context/AuthContext';\r\n\r\nconst TourDetails = () => {\r\n\r\n  const {id} = useParams()\r\n  const reviewMsgRef = useRef('')\r\n  const [tourRating, setTourRating] = useState(null)\r\n  const {user} = useContext(AuthContext)\r\n//fetch data from database\r\nconst {data:tour, loading, error} = useFetch(`${BASE_URL}/tours/${id}`)\r\n//destructure properties from tour object\r\n  const {photo, title , desc ,price ,address, reviews , city ,distance , maxGroupSiz} =\r\n  tour;\r\n\r\n  const {totalRating,avgRating} = calculateAvgRating\r\n  (reviews)\r\n\r\n  //format date\r\n  const Options = {day:'numeric' ,month:'long',year:'numeric' };\r\n\r\n  // submit request to the server\r\n  const submitHandler = async e => {\r\n    e.preventDefault();\r\n    const reviewText = reviewMsgRef.current.value;\r\n\r\n\r\n\r\n      try {\r\n        if(!user || user===undefined || user===null){\r\n          alert('Please sign in')\r\n        }\r\n        const reviewObj = {\r\n          username:user?.username,\r\n          reviewText,\r\n          rating: tourRating,\r\n        };\r\n      const res = await fetch(`${BASE_URL}/review/${id}`, {\r\n        method:\"POST\",\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: \"include\",\r\n        body: JSON.stringify(reviewObj),\r\n      });\r\n\r\n      const result= await res.json();\r\n      if(!res.ok) {\r\n        return alert(result.message);\r\n      }\r\n\r\n\r\n      alert(result.message)\r\n    } catch (err) {\r\n      alert(err.message);\r\n    }\r\n  };\r\n\r\n  useEffect(() =>{\r\n    window.scrollTo(0,0)\r\n  },[tour]);\r\n    return (\r\n    <>\r\n    <section>\r\n        <Container>\r\n        {loading && <h4 class=\"text-center pt-5\">Loading......</h4>}\r\n        {error && <h4 class=\"text-center pt-5\">{error}</h4>}\r\n\r\n          {\r\n            !loading && !error && <Row>\r\n            <Col lg='8'>\r\n              <div className='tour__content' >\r\n                 <img src={photo} alt='' />\r\n\r\n                <div className='tour__info' >\r\n                  <h2>{title}</h2>\r\n\r\n            <div className='d-flex \r\n            align-items-center gap-5'>\r\n            <span className='tour__rating d-flex \r\n            align-items-center gap-1 '>\r\n          <i class=\"ri-star-fill\" style=\r\n          {{color:'var(--secondary-color) '}}\r\n          ></i> \r\n          {avgRating === 0 ? null :\r\n           avgRating}\r\n          {totalRating === 0 ?( \r\n            'not rated' \r\n          ) : (\r\n           <span> ({reviews?.length}) </span>\r\n           )}\r\n          </span>\r\n          <span>\r\n          <i class=\"ri-map-pin-fill\"></i> {address}\r\n          </span>\r\n          <div className='tour__extra-details'>\r\n            <span><i class=\"ri-map-pin-2-line\"></i> {city}</span>\r\n            <span><i class=\"ri-money-dollar-circle-line\"></i> ${price} / per personne </span>\r\n            <span><i class=\"ri-map-pin-time-line\"></i> {distance} k/m </span>\r\n            <span><i class=\"ri-group-line\"></i> {maxGroupSiz} people\r\n            </span>\r\n          </div>\r\n            </div>\r\n            <h5>Description</h5>\r\n            <p>{desc}</p>\r\n            </div>\r\n            {/* ========= tour reviews section ======= */ /*}\r\n                                                          <div className='tour__reviews mt-4 '>\r\n                                                          <h4>Reviews ({reviews?.length} reviews ) </h4>\r\n                                                          <Form onSubmit={submitHandler}>\r\n                                                          <div className='d-flex align-items-center gap-3 mb-4 rating__group'>\r\n                                                          <span onClick={()=> setTourRating(1)}>1<i class=\"ri-star-fill\"></i></span>\r\n                                                          <span onClick={()=> setTourRating(2)}>2<i class=\"ri-star-fill\"></i></span>\r\n                                                          <span onClick={()=> setTourRating(3)}>3<i class=\"ri-star-fill\"></i></span>\r\n                                                          <span onClick={()=> setTourRating(4)}>4<i class=\"ri-star-fill\"></i></span>\r\n                                                          <span onClick={()=> setTourRating(5)}>5<i class=\"ri-star-fill\"></i></span>\r\n                                                          </div>\r\n                                                          <div className='review__input'>\r\n                                                          <input type='text' ref={reviewMsgRef} placeholder='share your thoughts'\r\n                                                          required\r\n                                                          />\r\n                                                          <button className='btn primary__btn text-white'\r\n                                                          type='submit'>Submit</button> \r\n                                                          </div>\r\n                                                          </Form>\r\n                                                          <ListGroup className='user__reviews'>\r\n                                                          {\r\n                                                          reviews?.map(reviews=>(\r\n                                                          <div className='review__items'>\r\n                                                          <img src={avatar} alt='' />\r\n                                                          <div className='w-100'>\r\n                                                          <div className='d-flex align-items-center justify-content-between'>\r\n                                                          <div>\r\n                                                          <h5>{reviews.username}</h5>\r\n                                                          <p>\r\n                                                          {\r\n                                                          new Date(reviews.createdAt).toLocaleDateString (\r\n                                                          'en-US' , Options\r\n                                                          )}\r\n                                                          </p>\r\n                                                          </div>\r\n                                                          <span className='d-flex align-items-center'>\r\n                                                          {reviews.rating}\r\n                                                          <i className='ri-star-fill'></i>\r\n                                                          </span>\r\n                                                          <h6>{reviews.reviewText}</h6>\r\n                                                          </div>\r\n                                                          </div>\r\n                                                          </div>\r\n                                                          ))\r\n                                                          }\r\n                                                          </ListGroup>\r\n                                                          </div> \r\n                                                          {/* ========= tour reviews section ======= */ /*}\r\n                                                                                                        </div>\r\n                                                                                                        </Col>\r\n                                                                                                        <Col lg='4'>\r\n                                                                                                        <Booking tour={tour} avgRating={avgRating} />\r\n                                                                                                        </Col>\r\n                                                                                                        </Row>\r\n                                                                                                        }\r\n                                                                                                        </Container>\r\n                                                                                                        </section>\r\n                                                                                                        </>\r\n                                                                                                        );\r\n                                                                                                        };\r\n                                                                                                        export default TourDetails;\r\n                                                                                                        */","map":{"version":3,"names":[],"sources":["C:/Users/GMI/Desktop/projet site booking/tour-management/frontend/src/pages/TourDetails.jsx"],"sourcesContent":["/*import React,{useEffect, useRef,useState,useContext} from 'react'\r\nimport '../styles/tour-details.css'\r\nimport { Container , Row , Col , Form , ListGroup } from 'reactstrap'\r\nimport { useParams } from 'react-router-dom';\r\n\r\nimport calculateAvgRating from '../utils/avgRating';\r\nimport avatar from '../assets/images/avatar.jpg'\r\nimport Booking from '../components/Booking/Booking';\r\nimport useFetch from './../hooks/useFetch';\r\nimport {BASE_URL} from './../utils/config';\r\n\r\nimport { AuthContext } from './../context/AuthContext';\r\n\r\nconst TourDetails = () => {\r\n\r\n  const {id} = useParams()\r\n  const reviewMsgRef = useRef('')\r\n  const [tourRating, setTourRating] = useState(null)\r\n  const {user} = useContext(AuthContext)\r\n//fetch data from database\r\nconst {data:tour, loading, error} = useFetch(`${BASE_URL}/tours/${id}`)\r\n//destructure properties from tour object\r\n  const {photo, title , desc ,price ,address, reviews , city ,distance , maxGroupSiz} =\r\n  tour;\r\n\r\n  const {totalRating,avgRating} = calculateAvgRating\r\n  (reviews)\r\n\r\n  //format date\r\n  const Options = {day:'numeric' ,month:'long',year:'numeric' };\r\n\r\n  // submit request to the server\r\n  const submitHandler = async e => {\r\n    e.preventDefault();\r\n    const reviewText = reviewMsgRef.current.value;\r\n\r\n\r\n\r\n      try {\r\n        if(!user || user===undefined || user===null){\r\n          alert('Please sign in')\r\n        }\r\n        const reviewObj = {\r\n          username:user?.username,\r\n          reviewText,\r\n          rating: tourRating,\r\n        };\r\n      const res = await fetch(`${BASE_URL}/review/${id}`, {\r\n        method:\"POST\",\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: \"include\",\r\n        body: JSON.stringify(reviewObj),\r\n      });\r\n\r\n      const result= await res.json();\r\n      if(!res.ok) {\r\n        return alert(result.message);\r\n      }\r\n\r\n\r\n      alert(result.message)\r\n    } catch (err) {\r\n      alert(err.message);\r\n    }\r\n  };\r\n\r\n  useEffect(() =>{\r\n    window.scrollTo(0,0)\r\n  },[tour]);\r\n    return (\r\n    <>\r\n    <section>\r\n        <Container>\r\n        {loading && <h4 class=\"text-center pt-5\">Loading......</h4>}\r\n        {error && <h4 class=\"text-center pt-5\">{error}</h4>}\r\n\r\n          {\r\n            !loading && !error && <Row>\r\n            <Col lg='8'>\r\n              <div className='tour__content' >\r\n                 <img src={photo} alt='' />\r\n\r\n                <div className='tour__info' >\r\n                  <h2>{title}</h2>\r\n\r\n            <div className='d-flex \r\n            align-items-center gap-5'>\r\n            <span className='tour__rating d-flex \r\n            align-items-center gap-1 '>\r\n          <i class=\"ri-star-fill\" style=\r\n          {{color:'var(--secondary-color) '}}\r\n          ></i> \r\n          {avgRating === 0 ? null :\r\n           avgRating}\r\n          {totalRating === 0 ?( \r\n            'not rated' \r\n          ) : (\r\n           <span> ({reviews?.length}) </span>\r\n           )}\r\n          </span>\r\n          <span>\r\n          <i class=\"ri-map-pin-fill\"></i> {address}\r\n          </span>\r\n          <div className='tour__extra-details'>\r\n            <span><i class=\"ri-map-pin-2-line\"></i> {city}</span>\r\n            <span><i class=\"ri-money-dollar-circle-line\"></i> ${price} / per personne </span>\r\n            <span><i class=\"ri-map-pin-time-line\"></i> {distance} k/m </span>\r\n            <span><i class=\"ri-group-line\"></i> {maxGroupSiz} people\r\n            </span>\r\n          </div>\r\n            </div>\r\n            <h5>Description</h5>\r\n            <p>{desc}</p>\r\n            </div>\r\n            {/* ========= tour reviews section ======= */ /*}\r\n            <div className='tour__reviews mt-4 '>\r\n            <h4>Reviews ({reviews?.length} reviews ) </h4>\r\n\r\n            <Form onSubmit={submitHandler}>\r\n              <div className='d-flex align-items-center gap-3 mb-4 rating__group'>\r\n                <span onClick={()=> setTourRating(1)}>1<i class=\"ri-star-fill\"></i></span>\r\n                <span onClick={()=> setTourRating(2)}>2<i class=\"ri-star-fill\"></i></span>\r\n                <span onClick={()=> setTourRating(3)}>3<i class=\"ri-star-fill\"></i></span>\r\n                <span onClick={()=> setTourRating(4)}>4<i class=\"ri-star-fill\"></i></span>\r\n                <span onClick={()=> setTourRating(5)}>5<i class=\"ri-star-fill\"></i></span>\r\n              </div>\r\n\r\n              <div className='review__input'>\r\n                <input type='text' ref={reviewMsgRef} placeholder='share your thoughts'\r\n                  required\r\n                />\r\n                <button className='btn primary__btn text-white'\r\n                type='submit'>Submit</button> \r\n              </div>\r\n            </Form>\r\n\r\n            <ListGroup className='user__reviews'>\r\n            {\r\n              reviews?.map(reviews=>(\r\n                <div className='review__items'>\r\n                  <img src={avatar} alt='' />\r\n\r\n                  <div className='w-100'>\r\n                    <div className='d-flex align-items-center justify-content-between'>\r\n                      <div>\r\n                        <h5>{reviews.username}</h5>\r\n                        <p>\r\n                          {\r\n                            new Date(reviews.createdAt).toLocaleDateString (\r\n                              'en-US' , Options\r\n              )}\r\n                        </p>\r\n                      </div>\r\n                      <span className='d-flex align-items-center'>\r\n                        {reviews.rating}\r\n                        <i className='ri-star-fill'></i>\r\n                      </span>\r\n\r\n                      <h6>{reviews.reviewText}</h6>\r\n\r\n\r\n                    </div>\r\n                  </div>\r\n\r\n\r\n\r\n                </div>\r\n              ))\r\n            }\r\n            </ListGroup>\r\n\r\n\r\n\r\n            </div> \r\n             {/* ========= tour reviews section ======= */ /*}\r\n            </div>\r\n          </Col>\r\n          <Col lg='4'>\r\n            <Booking tour={tour} avgRating={avgRating} />\r\n          </Col>\r\n        </Row>\r\n          }\r\n      </Container>\r\n     </section>\r\n    \r\n     \r\n     \r\n\r\n    </>\r\n    );\r\n    };\r\n    \r\n\r\n\r\nexport default TourDetails;\r\n*/"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDApHA,CAoH0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uGA/C0D,CA4DC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}